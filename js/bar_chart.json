{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Hospital Count Comparison by State (Australia)",
  "width": 520,
  "height": 320,
  "data": {
    "url": "https://raw.githubusercontent.com/yu-heng-seow/FIT3179_W9_HW/refs/heads/main/data/list-of-declared-hospitals_0.csv",
    "format": {"type": "csv"}
  },
  "params": [
    {
      "name": "state_selection",
      "bind": {
        "input": "select",
        "options": [null, "NSW", "VIC", "QLD", "WA", "SA", "TAS", "NT", "ACT"],
        "labels": [
          "Show All",
          "NSW",
          "VIC",
          "QLD",
          "WA",
          "SA",
          "TAS",
          "NT",
          "ACT"
        ],
        "name": "Select State: "
      },
      "value": null
    }
  ],
  "transform": [
    {"filter": "datum.State != null && datum.State != ''"},
    {"aggregate": [{"op": "count", "as": "HospitalCount"}], "groupby": ["State"]},
    {"filter": "state_selection == null || datum.State == state_selection"}
  ],
  "layer": [
    {
      "mark": {
        "type": "bar",
        "cornerRadiusTopLeft": 4,
        "cornerRadiusTopRight": 4
      },
      "encoding": {
        "x": {
          "field": "State",
          "type": "nominal",
          "title": "State",
          "sort": ["NSW", "VIC", "QLD", "WA", "SA", "TAS", "NT", "ACT"],
          "axis": {
            "labelAngle": 0,
            "labelFontSize": 12,
            "titleFontSize": 13,
            "labelFontWeight": "bold"
          }
        },
        "y": {
          "field": "HospitalCount",
          "type": "quantitative",
          "title": "Number of Hospitals",
          "axis": {
            "labelFontSize": 12,
            "titleFontSize": 13,
            "grid": true
          }
        },
        "color": {
          "field": "HospitalCount",
          "type": "quantitative",
          "scale": {"scheme": "blues"},
          "legend": {"title": "Hospitals"}
        },
        "tooltip": [
          {"field": "State", "title": "State"},
          {"field": "HospitalCount", "title": "Hospitals"}
        ]
      }
    },
    {
      "transform": [
        {"aggregate": [{"op": "max", "field": "HospitalCount", "as": "MaxHosp"}]}
      ],
      "mark": {"type": "rule", "color": "red", "strokeDash": [4, 4]},
      "encoding": {
        "y": {"field": "MaxHosp", "type": "quantitative"},
        "tooltip": [{"field": "MaxHosp", "title": "Highest Count"}]
      }
    }
  ]
}
